(this["webpackJsonptracery-builder"]=this["webpackJsonptracery-builder"]||[]).push([[0],{12:function(e,t,n){e.exports=n(19)},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),i=(n(17),n(2)),u=n(4),l=n.n(u),s=n(6),m=n(1),d=(n(9),function(e){var t=e.name,n=e.displayPopover,a=e.isPopoverActive,o=e.activeButton,c=e.hidePopover,i=e.content,u=e.children,l=e.injectCallback,s=a&&o===t,m="ruleButton ".concat(s?"selectedButton":"unselectedButton"),d=i||u,h=null;return d&&l&&(h=r.a.cloneElement(d,{onFinished:c})),r.a.createElement("div",{className:"ruleButtonDiv"},r.a.createElement("button",{onClick:function(e){e.stopPropagation(),s?c(e):(a&&c(),n(t,h||d||""))},className:m},t))}),h=function(e){var t=e.rules,n=e.setRules,a=e.onFinished,o=r.a.useState({canonical:"",display:""}),c=Object(m.a)(o,2),u=c[0],l=c[1],s=r.a.useRef(null);return r.a.useEffect((function(){s.current.focus()}),[]),r.a.createElement("div",{id:"AddRulesPopover",className:"AddPopover"},r.a.createElement("h2",null,"Add Rules"),r.a.createElement("p",null,"Enter a rule name below to create a new Tracery rule. The rule can then be reference using the format ",r.a.createElement("code",null,"#ruleName#")),r.a.createElement("form",{id:"addRuleForm",onSubmit:function(e){a&&a(),e.preventDefault()}},r.a.createElement("label",{htmlFor:"ruleInput"},"Rule name:"),r.a.createElement("input",{id:"ruleInput",ref:s,type:"text",value:u.display,onChange:function(e){var a=e.target.value;if(t.find((function(e){return e.name===a})))n(t),l((function(e){return{canonical:e.canonical,display:a}}));else{var r=Object(i.a)(t);r.push({name:a,contents:[]}),n(r),l({canonical:a,display:a})}},className:"addInput"})),r.a.createElement("div",{id:"bottomButtons"},r.a.createElement("button",{type:"submit",form:"addRuleForm"},"Finished")))},p=n(11),f=function(e){var t=e.contents,n=e.setRules,a=e.onFinished,o=e.index,c=e.isDeleteable,u=r.a.useState(t),l=Object(m.a)(u,2),s=l[0],d=l[1],h=function(e){return function(t){var n=t.target.value;d((function(t){var a=Object(i.a)(t);return a[e]=n,a}))}},f=function(e){return function(){d((function(t){return t.filter((function(t,n){return e!==n}))}))}};r.a.useEffect((function(){n((function(e){var t=Object(i.a)(e);return t[o]={name:e[o].name,contents:s},t}))}),[s,o,n]);return r.a.createElement("div",{id:"AddContentsPopover",className:"AddPopover"},r.a.createElement("h2",null,"Add Contents"),r.a.createElement("p",null,"Click the button below to add a content choice to the list of contents, or edit an existing content choice using the input fields."),r.a.createElement("form",{id:"addContentsForm",onSubmit:function(e){a&&a(),e.preventDefault()}},s.map((function(e,t){return r.a.createElement("div",{className:"contentRow",key:t},r.a.createElement(p.a,{type:"text",value:s[t],onChange:h(t),className:"addInput"}),r.a.createElement("button",{type:"button",onClick:f(t)},"Delete"))})),r.a.createElement("div",{id:"bottomButtons"},r.a.createElement("button",{type:"button",onClick:function(){d((function(e){var t=Object(i.a)(e);return t.push(""),t}))}},"Add content choice"),c?r.a.createElement("button",{type:"button",onClick:function(){n((function(e){return e.filter((function(e,t){return t!==o}))})),a()}},"Delete rule"):null,r.a.createElement("button",{type:"submit",form:"addContentsForm"},"Finished"))))},b=n(7),v=n.n(b),E=function(e){var t=e.isFrozen,n=e.setIsFrozen,a=t?"Unfreeze":"Freeze";return r.a.createElement("button",{type:"button",onClick:function(){return n(!t)}},a)},g=function(){var e=r.a.useState(!1),t=Object(m.a)(e,2),n=t[0],a=t[1],o=r.a.useState(null),c=Object(m.a)(o,2),u=c[0],p=c[1],b=r.a.useState(""),g=Object(m.a)(b,2),y=g[0],k=g[1],C=r.a.useState(!1),w=Object(m.a)(C,2),T=w[0],j=w[1],x=r.a.useState([{name:"origin",contents:["Start editing rules to generate text"]}]),B=Object(m.a)(x,2),O=B[0],S=B[1],A=r.a.useState([]),F=Object(m.a)(A,2),P=F[0],R=F[1],z=r.a.useState(!1),D=Object(m.a)(z,2),G=D[0],N=D[1],W=r.a.useState([]),I=Object(m.a)(W,2),M=I[0],J=I[1];function L(e){return new Promise((function(t){return setTimeout(t,e)}))}var K=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.target!==t.currentTarget){e.next=8;break}return j(!0),e.next=4,L(201);case 4:a(!1),j(!1),k(""),R((function(e){return e.filter((function(e){return""!==e.name}))}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(s.a)(l.a.mark((function e(t,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,K();case 3:p(r),a(!0),k(t);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(e){var t=e.name,a=e.content,o=e.children,c=e.injectCallback;return r.a.createElement(d,{name:t,displayPopover:U,isPopoverActive:n,activeButton:y,hidePopover:K,content:a,injectCallback:c},o)},$=T?"slide-out":"slide-in";return r.a.useEffect((function(){if(!G){var e=P.reduce((function(e,t){return e[t.name]=t.contents,e}),{});e.origin=O[0].contents;var t=v.a.createGrammar(e);t.addModifiers(v.a.baseEngModifiers),J(t.flatten("#origin#").split("\n"))}}),[P,O,G]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"sidebar",onClick:function(e){return K(e)}},r.a.createElement("div",{id:"dynamicContent"},r.a.createElement(Y,{name:O[0].name,injectCallback:!0},r.a.createElement(f,{contents:O[0].contents,setRules:S,index:0,isDeleteable:!1})),P.map((function(e,t){return r.a.createElement(Y,{key:t,name:e.name,injectCallback:!0},r.a.createElement(f,{contents:e.contents,setRules:R,index:t,isDeleteable:!0}))}))),r.a.createElement("div",{id:"staticContent"},r.a.createElement("div",{className:"ruleButtonDiv"},r.a.createElement("button",{type:"button",className:"ruleButton unselectedButton",onClick:function(){S([{name:"origin",contents:["Start editing rules to generate text"]}]),R([])}},"Clear Rules")),r.a.createElement(Y,{name:"Add Rule",injectCallback:!0},r.a.createElement(h,{rules:P,setRules:R})))),r.a.createElement("div",{id:"viewport",onClick:function(e){return K(e)}},n?r.a.createElement("div",{id:"popover",className:$},u):null,r.a.createElement("div",{id:"viewport-contents"},r.a.createElement("h2",null,"Tracery Builder"),r.a.createElement("p",null,"This is a react app that can be used to build grammars for Kate Compton's"," ",r.a.createElement("a",{href:"https://github.com/galaxykate/tracery"},"Tracery language"),". The origin rule is always the starting point and cannot be deleted. Additional rules can be added using the Add Rule button at the bottom of the sidebar. Clicking a rule in the sidebar will allow you to edit or delete the rule."),r.a.createElement("p",null,"To generate a new expansion, click Generate. To prevent the current expansion from being overwritten, click the Freeze button. Click it again to resume generating expansions."),r.a.createElement("p",null,"To load a simple example grammar:"," ",r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),S([{name:"origin",contents:['"Guess what?"\n"What?"\n"#Guess What#."','"Guess why?"\n"Why?"\n"#Guess Why#."','"Guess who?"\n"Who?"\n"#Guess Who#."']}]),R([{name:"Guess What",contents:["Chicken Butt"]},{name:"Guess Why",contents:["Chicken Pot Pie","Chicken Thigh"]},{name:"Guess Who",contents:["Chicken Stew","Chicken Cordon Bleu"]}])}},"click here"),".",r.a.createElement("br",null),"To load a complex example grammar:"," ",r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),S([{name:"origin",contents:["Once upon a time, #[#setCharacter#]story#"]}]),R([{name:"name",contents:["Arjun","Yuuma","Darcy","Mia","Chiaki","Izzi","Azra","Lina"]},{name:"animal",contents:["unicorn","raven","sparrow","scorpion","coyote","eagle","owl","lizard","zebra","duck","kitten"]},{name:"occupationBase",contents:["wizard","witch","detective","ballerina","criminal","pirate","lumberjack","spy","doctor","scientist","captain","priest"]},{name:"occupationMod",contents:["occult ","space ","professional ","gentleman ","erotic ","time ","cyber","paleo","techno","super"]},{name:"strange",contents:["mysterious","portentous","enchanting","strange","eerie"]},{name:"tale",contents:["story","saga","tale","legend"]},{name:"occupation",contents:["#occupationMod##occupationBase#"]},{name:"mood",contents:["vexed","indignant","impassioned","wistful","astute","courteous"]},{name:"setPronouns",contents:["[heroThey:they][heroThem:them][heroTheir:their][heroTheirs:theirs]","[heroThey:she][heroThem:her][heroTheir:her][heroTheirs:hers]","[heroThey:he][heroThem:him][heroTheir:his][heroTheirs:his]"]},{name:"setSail",contents:["set sail for adventure","left #heroTheir# home","set out for adventure","went to seek #heroTheir# forture"]},{name:"setCharacter",contents:["[#setPronouns#][hero:#name#][heroJob:#occupation#]"]},{name:"openBook",contents:["An old #occupation# told #hero# a story. 'Listen well' she said to #hero#, 'to this #strange# #tale#. ' #origin#'","#hero# went home.","#hero# found an ancient book and opened it.  As #hero# read, the book told #strange.a# #tale#: #origin#"]},{name:"story",contents:["#hero# the #heroJob# #setSail#. #openBook#"]}])}},"click here"),"."),r.a.createElement("div",{id:"tracery-container"},r.a.createElement("div",{id:"tracery-contents"},M.map((function(e,t){return r.a.createElement("span",{key:t},e,r.a.createElement("br",null))})),r.a.createElement("div",{id:"bottomButtons"},r.a.createElement(E,{isFrozen:G,setIsFrozen:N}),r.a.createElement("button",{type:"button",onClick:function(){return R((function(e){return Object(i.a)(e)}))}},"Generate")))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){}},[[12,1,2]]]);
//# sourceMappingURL=main.e68842e7.chunk.js.map